#!/bin/sh

# Run this once per day (or whenever the file contents change).
# date: {{ output "date" "+%Y-%m-%d" }}

set -o errexit
set -o xtrace

if command -v brew >/dev/null 2>&1; then
  brew_prefix="$(brew --prefix)"
  # -O: True if file exists and its owner matches the effective user id of this
  # process.
  if [ -O "$brew_prefix" ]; then
    brew upgrade
  fi
fi

if command -v apt-get >/dev/null 2>&1; then
  if command -v sudo >/dev/null 2>&1 && sudo --validate --non-interactive >/dev/null 2>&1; then
    export DEBIAN_FRONTEND=noninteractive
    sudo apt-get update
    sudo apt-get upgrade --yes
  fi
fi
