#!/usr/bin/env zsh

if ! in_git_repo; then
  echo "Not in git repository."
  exit 128
fi

if [[ "$1" == "" ]]; then
  echo -n "Getting remote HEAD... "
  GIT_HEAD="$(get_remote_head)"
  echo $GIT_HEAD

  echo_run git fetch --quiet --tags && \
  echo_run git rebase origin/$GIT_HEAD
  return $?
fi

if [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
  echo "Usage: $0 [<git rebase args>]"
  echo
  safe_run git rebase --help
  return
fi

echo_run git fetch --quiet --tags && \
echo_run git rebase $@
